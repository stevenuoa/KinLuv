Module states4 imported successfully
Found main function in states4

┌──────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│                                                                              │
│                o WELCOME TO FOUR STATES KINETICS CALCULATIONS o                │
│                                                                              │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘


 >>> Running 4-states module with the following parameters: 

k_abss0s1: 1.00e+13
k_iscs1t1: 1.00e+07
k_iscs1t2: 1.00e+07
k_isct1s0: 1.00e+04
k_risct1s1: 1.00e+05
k_risct2s1: 1.00e+05
k_fls1s0: 1.00e+07
k_ics1s0: 1.00e+07
k_ict2t1: 1.00e+12
k_ict1t2: 0.00e+00
k_pht1s0: 1.00e+02

────────────────────────────────────────────────────────────────────────────────
│                                                                              │
                    → Step 1: Running the excitation solver                     
│                                                                              │
────────────────────────────────────────────────────────────────────────────────


 >>> Solving the excitation kinetics...


 >>> Numerical solution : 

 Population evolution of state: S0 
  S0(1.000e-15 s) = 9.900e-01
  S0(1.001e-15 s) = 9.900e-01
  S0(1.003e-15 s) = 9.900e-01
  S0(1.004e-15 s) = 9.900e-01
  S0(1.006e-15 s) = 9.900e-01
  ...
  S0(9.945e-10 s) = 1.961e-06
  S0(9.959e-10 s) = 1.961e-06
  S0(9.972e-10 s) = 1.961e-06
  S0(9.986e-10 s) = 1.960e-06
  S0(1.000e-09 s) = 1.960e-06

 Population evolution of state: S1 
  S1(1.000e-15 s) = 9.950e-03
  S1(1.001e-15 s) = 9.964e-03
  S1(1.003e-15 s) = 9.978e-03
  S1(1.004e-15 s) = 9.991e-03
  S1(1.006e-15 s) = 1.001e-02
  ...
  S1(9.945e-10 s) = 9.803e-01
  S1(9.959e-10 s) = 9.803e-01
  S1(9.972e-10 s) = 9.803e-01
  S1(9.986e-10 s) = 9.802e-01
  S1(1.000e-09 s) = 9.802e-01

 Population evolution of state: T1 
  T1(1.000e-15 s) = 4.985e-11
  T1(1.001e-15 s) = 4.999e-11
  T1(1.003e-15 s) = 5.013e-11
  T1(1.004e-15 s) = 5.026e-11
  T1(1.006e-15 s) = 5.040e-11
  ...
  T1(9.945e-10 s) = 1.968e-02
  T1(9.959e-10 s) = 1.971e-02
  T1(9.972e-10 s) = 1.973e-02
  T1(9.986e-10 s) = 1.976e-02
  T1(1.000e-09 s) = 1.979e-02

 Population evolution of state: T2 
  T2(1.000e-15 s) = 4.982e-11
  T2(1.001e-15 s) = 4.995e-11
  T2(1.003e-15 s) = 5.009e-11
  T2(1.004e-15 s) = 5.023e-11
  T2(1.006e-15 s) = 5.037e-11
  ...
  T2(9.945e-10 s) = 9.803e-06
  T2(9.959e-10 s) = 9.803e-06
  T2(9.972e-10 s) = 9.803e-06
  T2(9.986e-10 s) = 9.802e-06
  T2(1.000e-09 s) = 9.802e-06

 Population after pulse duration 1.00e-11 s:
  S0 = 2.000e-06
  S1 = 9.998e-01
  T1 = 1.880e-04
  T2 = 9.998e-06


────────────────────────────────────────────────────────────────────────────────
│                                                                              │
                       → Step 2: Running the decay solver                       
│                                                                              │
────────────────────────────────────────────────────────────────────────────────


 >>> Solving the decay kinetics...


Initial Population for decay:
  S0 :  2.000e-06
  S1 :  9.998e-01
  T1 :  1.880e-04
  T2 :  9.998e-06


 >>> Numerical solution : 

 Population evolution of state: S0 
  S0(1.000e-12 s) = 2.200e-05
  S0(1.001e-12 s) = 2.202e-05
  S0(1.002e-12 s) = 2.204e-05
  S0(1.003e-12 s) = 2.206e-05
  S0(1.005e-12 s) = 2.209e-05
  ...
  S0(9.963e-04 s) = 1.000e+00
  S0(9.972e-04 s) = 1.000e+00
  S0(9.982e-04 s) = 1.000e+00
  S0(9.991e-04 s) = 1.000e+00
  S0(1.000e-03 s) = 1.000e+00

 Population evolution of state: S1 
  S1(1.000e-12 s) = 9.998e-01
  S1(1.001e-12 s) = 9.998e-01
  S1(1.002e-12 s) = 9.998e-01
  S1(1.003e-12 s) = 9.998e-01
  S1(1.005e-12 s) = 9.998e-01
  ...
  S1(9.963e-04 s) = 1.334e-29
  S1(9.972e-04 s) = 1.262e-29
  S1(9.982e-04 s) = 1.195e-29
  S1(9.991e-04 s) = 1.131e-29
  S1(1.000e-03 s) = 1.070e-29

 Population evolution of state: T1 
  T1(1.000e-12 s) = 2.080e-04
  T1(1.001e-12 s) = 2.080e-04
  T1(1.002e-12 s) = 2.080e-04
  T1(1.003e-12 s) = 2.080e-04
  T1(1.005e-12 s) = 2.081e-04
  ...
  T1(9.963e-04 s) = 5.328e-27
  T1(9.972e-04 s) = 5.042e-27
  T1(9.982e-04 s) = 4.772e-27
  T1(9.991e-04 s) = 4.515e-27
  T1(1.000e-03 s) = 4.273e-27

 Population evolution of state: T2 
  T2(1.000e-12 s) = 9.998e-06
  T2(1.001e-12 s) = 9.998e-06
  T2(1.002e-12 s) = 9.998e-06
  T2(1.003e-12 s) = 9.998e-06
  T2(1.005e-12 s) = 9.998e-06
  ...
  T2(9.963e-04 s) = 1.334e-34
  T2(9.972e-04 s) = 1.262e-34
  T2(9.982e-04 s) = 1.195e-34
  T2(9.991e-04 s) = 1.131e-34
  T2(1.000e-03 s) = 1.070e-34

————————————————————————————————————————

 Initial Two Exponential Fit:

————————————————————————————————————————

 Model:

 y = A1 * exp(-t/tau1) + A2 * exp(-t/tau2) + C

 >>> Initial fitted guess:
 [0.3907281704164482, -7.691344395815255, 0.6088484941396208, -7.544406100001355, 0.0005660023797980287]

————————————————————————————————————————

 Final Two Exponential Fit:

————————————————————————————————————————

 Model:

 y = A1 * exp(-t/tau1) + A2 * exp(-t/tau2) + C

 >>> Fitted decay parameters are:

A1   = 9.987e-01
tau1 = 2.495e-08
A2   = 1.264e-03
tau2 = 1.656e-05
C    = 3.526e-14

MSE:  1.024e-08
RMSE: 1.012e-04
R^2:  1.000


 Fitted figure successfully saved to results_4states/decay_fit.pdf 


────────────────────────────────────────────────────────────────────────────────
│                                                                              │
                → Step 3: Running the quantum yield calculation                 
│                                                                              │
────────────────────────────────────────────────────────────────────────────────


 >>> Calculating the quantum yield...

 Expressions of different state population with S1: 
 S0 =  2.18346956394187e-6*S1
 T1 =  181.653033605814*S1
 T2 =  9.9999990000001e-6*S1

 Quantum Yield of Fluorescence (%): 
 45.80% 


────────────────────────────────────────────────────────────────────────────────
│                                                                              │
                          → Step 4: Plotting kinetics                           
│                                                                              │
────────────────────────────────────────────────────────────────────────────────


 >>> Generating plots for excitation and decay kinetics...

Kinetics data successfully saved to results_4states/kinetics_data.out

Figure successfully saved to results_4states/kinetics_plot.pdf


┌──────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│                                                                              │
│                           o CALCULATIONS COMPLETE o                            │
│                                                                              │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

──────────┘

